-- Generated by Oracle SQL Developer Data Modeler 19.4.0.350.1424
--   at:        2020-05-21 00:36:01 EEST
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



CREATE TABLE car (
    car_vin              VARCHAR2(30) NOT NULL,
    car_model            VARCHAR2(100) NOT NULL,
    car_color            VARCHAR2(50) NOT NULL,
    car_fuel             VARCHAR2(20) NOT NULL,
    car_type             VARCHAR2(50) NOT NULL,
    car_transmission     VARCHAR2(20) NOT NULL,
    car_count_cylynders  INTEGER NOT NULL,
    car_year             INTEGER NOT NULL,
    car_mileage          INTEGER,
    car_condition        VARCHAR2(50),
    car_drive            VARCHAR2(20) NOT NULL
);

ALTER TABLE car ADD CONSTRAINT car_pk PRIMARY KEY ( car_vin );

CREATE TABLE car_cylinders (
    count_cylinders INTEGER NOT NULL
);

ALTER TABLE car_cylinders ADD CONSTRAINT car_cylinders_pk PRIMARY KEY ( count_cylinders );

CREATE TABLE car_model (
    model_name          VARCHAR2(100) NOT NULL,
    model_manufactured  VARCHAR2(100) NOT NULL
);

ALTER TABLE car_model ADD CONSTRAINT car_model_pk PRIMARY KEY ( model_name );

CREATE TABLE car_type (
    type_name VARCHAR2(50) NOT NULL
);

ALTER TABLE car_type ADD CONSTRAINT car_type_pk PRIMARY KEY ( type_name );

CREATE TABLE color (
    color_name VARCHAR2(50) NOT NULL
);

ALTER TABLE color ADD CONSTRAINT color_pk PRIMARY KEY ( color_name );

CREATE TABLE customer (
    cust_id    VARCHAR2(30) NOT NULL,
    cust_name  VARCHAR2(50) NOT NULL
);

ALTER TABLE customer ADD CONSTRAINT customer_pk PRIMARY KEY ( cust_id );

CREATE TABLE drive (
    drive_name VARCHAR2(20) NOT NULL
);

ALTER TABLE drive ADD CONSTRAINT drive_pk PRIMARY KEY ( drive_name );

CREATE TABLE fuel (
    fuel_name VARCHAR2(20) NOT NULL
);

ALTER TABLE fuel ADD CONSTRAINT fuel_pk PRIMARY KEY ( fuel_name );

CREATE TABLE lot (
    lot_price   INTEGER NOT NULL,
    lot_vin     VARCHAR2(30) NOT NULL,
    lot_region  VARCHAR2(50) NOT NULL,
    lot_cust    VARCHAR2(30) NOT NULL
);

ALTER TABLE lot ADD CONSTRAINT lot_pk PRIMARY KEY ( lot_price,
                                                    lot_vin );

CREATE TABLE manufacturer (
    company_name VARCHAR2(100) NOT NULL
);

ALTER TABLE manufacturer ADD CONSTRAINT manufacturer_pk PRIMARY KEY ( company_name );

CREATE TABLE region (
    region_name   VARCHAR2(50) NOT NULL,
    region_state  VARCHAR2(5) NOT NULL
);

ALTER TABLE region ADD CONSTRAINT region_pk PRIMARY KEY ( region_name );

CREATE TABLE transmission (
    trans_name VARCHAR2(20) NOT NULL
);

ALTER TABLE transmission ADD CONSTRAINT transmission_pk PRIMARY KEY ( trans_name );

CREATE TABLE us_state (
    state_name VARCHAR2(5) NOT NULL
);

ALTER TABLE us_state ADD CONSTRAINT state_pk PRIMARY KEY ( state_name );

ALTER TABLE car
    ADD CONSTRAINT car_car_cylinders_fk FOREIGN KEY ( car_count_cylynders )
        REFERENCES car_cylinders ( count_cylinders );

ALTER TABLE car
    ADD CONSTRAINT car_car_model_fk FOREIGN KEY ( car_model )
        REFERENCES car_model ( model_name );

ALTER TABLE car
    ADD CONSTRAINT car_car_type_fk FOREIGN KEY ( car_type )
        REFERENCES car_type ( type_name );

ALTER TABLE car
    ADD CONSTRAINT car_color_fk FOREIGN KEY ( car_color )
        REFERENCES color ( color_name );

ALTER TABLE car
    ADD CONSTRAINT car_drive_fk FOREIGN KEY ( car_drive )
        REFERENCES drive ( drive_name );

ALTER TABLE car
    ADD CONSTRAINT car_fuel_fk FOREIGN KEY ( car_fuel )
        REFERENCES fuel ( fuel_name );

ALTER TABLE car_model
    ADD CONSTRAINT car_model_manufacturer_fk FOREIGN KEY ( model_manufactured )
        REFERENCES manufacturer ( company_name );

ALTER TABLE car
    ADD CONSTRAINT car_transmission_fk FOREIGN KEY ( car_transmission )
        REFERENCES transmission ( trans_name );

ALTER TABLE lot
    ADD CONSTRAINT lot_car_fk FOREIGN KEY ( lot_vin )
        REFERENCES car ( car_vin );

ALTER TABLE lot
    ADD CONSTRAINT lot_customer_fk FOREIGN KEY ( lot_cust )
        REFERENCES customer ( cust_id );

ALTER TABLE lot
    ADD CONSTRAINT lot_region_fk FOREIGN KEY ( lot_region )
        REFERENCES region ( region_name );

ALTER TABLE region
    ADD CONSTRAINT region_state_fk FOREIGN KEY ( region_state )
        REFERENCES us_state ( state_name );

CREATE or REPLACE TRIGGER lot_check_price
BEFORE INSERT on lot
for each row
DECLARE 
    price_error exception;
PRAGMA EXCEPTION_INIT (price_error, -2020);
begin
   IF :NEW.lot_price = 0 then 
        raise_application_error(-20200,'You have tried to input incorrect price');
    END IF;
end;

-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            13
-- CREATE INDEX                             0
-- ALTER TABLE                             25
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           1
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
